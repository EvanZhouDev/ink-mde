{"version":3,"file":"search-4vbOUsSl.js","sources":["../src/vendor/extensions/search.tsx"],"sourcesContent":["import { SearchQuery, findNext, findPrevious, getSearchQuery, search as searchExtension, searchKeymap, setSearchQuery } from '@codemirror/search'\nimport { keymap, runScopeHandlers } from '@codemirror/view'\nimport { createRoot, createSignal } from 'solid-js'\n\nexport const search = () => {\n  return [\n    searchExtension({\n      top: true,\n      createPanel: (view) => {\n        return createRoot((dispose) => {\n          const [query, setQuery] = createSignal(getSearchQuery(view.state))\n          let el: HTMLInputElement | undefined\n\n          const handleKeyDown = (event: KeyboardEvent) => {\n            if (runScopeHandlers(view, event, 'search-panel')) return event.preventDefault()\n\n            if (event.code === 'Enter') {\n              event.preventDefault()\n\n              if (event.shiftKey) {\n                findPrevious(view)\n              } else {\n                findNext(view)\n              }\n            }\n          }\n\n          const updateSearch = (event: InputEvent) => {\n            // @ts-expect-error \"value\" is not a recognized property of EventTarget.\n            const { value } = event.target\n\n            setQuery(new SearchQuery({ search: value }))\n            view.dispatch({ effects: setSearchQuery.of(query()) })\n          }\n\n          return {\n            destroy: () => {\n              dispose()\n            },\n            dom: (\n              <div class='ink-mde-search-panel' onKeyDown={handleKeyDown}>\n                <input attr:main-field='true' class='ink-mde-search-input' onInput={updateSearch} onKeyDown={handleKeyDown} ref={el} type=\"text\" value={query().search} />\n              </div>\n            ) as HTMLElement,\n            mount: () => {\n              el?.focus()\n            },\n            top: true,\n          }\n        })\n      },\n    }),\n    keymap.of(searchKeymap),\n  ]\n}\n"],"names":["search","searchExtension","top","createPanel","view","createRoot","dispose","query","setQuery","createSignal","getSearchQuery","state","destroy","dom","_$ssr","_tmpl$","_$ssrHydrationKey","_$ssrAttribute","_$escape","mount","keymap","of","searchKeymap"],"mappings":";;;;;;AAIaA,MAAAA,MAAM,GAAGA,MAAM;EAC1B,OAAO,CACLC,QAAe,CAAC;AACdC,IAAAA,GAAG,EAAE,IAAI;IACTC,WAAW,EAAGC,IAAI,IAAK;MACrB,OAAOC,UAAU,CAAEC,OAAO,IAAK;AAC7B,QAAA,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGC,YAAY,CAACC,cAAc,CAACN,IAAI,CAACO,KAAK,CAAC,CAAC,CAAA;QAyBlE,OAAO;UACLC,OAAO,EAAEA,MAAM;AACbN,YAAAA,OAAO,EAAE,CAAA;WACV;AACDO,UAAAA,GAAG,EAAAC,GAAA,CAAAC,MAAA,EAAAC,eAAA,IAEwB,MAAM,EAAAC,YAAA,CAAA,OAAA,EAAAC,MAAA,CAA2GX,KAAK,EAAE,CAACP,MAAM,EAE1I,IAAA,CAAA,EAAA,KAAA,CAAA,CAAA;UAChBmB,KAAK,EAAEA,MAAM;WAEZ;AACDjB,UAAAA,GAAG,EAAE,IAAA;SACN,CAAA;AACH,OAAC,CAAC,CAAA;AACJ,KAAA;GACD,CAAC,EACFkB,MAAM,CAACC,EAAE,CAACC,YAAY,CAAC,CACxB,CAAA;AACH;;;;"}
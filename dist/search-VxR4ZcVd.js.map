{"version":3,"file":"search-VxR4ZcVd.js","sources":["../src/vendor/extensions/search.tsx"],"sourcesContent":["import { SearchQuery, findNext, findPrevious, getSearchQuery, search as searchExtension, searchKeymap, setSearchQuery } from '@codemirror/search'\nimport { keymap, runScopeHandlers } from '@codemirror/view'\nimport { createRoot, createSignal } from 'solid-js'\n\nexport const search = () => {\n  return [\n    searchExtension({\n      top: true,\n      createPanel: (view) => {\n        return createRoot((dispose) => {\n          const [query, setQuery] = createSignal(getSearchQuery(view.state))\n          let el: HTMLInputElement | undefined\n\n          const handleKeyDown = (event: KeyboardEvent) => {\n            if (runScopeHandlers(view, event, 'search-panel')) return event.preventDefault()\n\n            if (event.code === 'Enter') {\n              event.preventDefault()\n\n              if (event.shiftKey) {\n                findPrevious(view)\n              } else {\n                findNext(view)\n              }\n            }\n          }\n\n          const updateSearch = (event: InputEvent) => {\n            // @ts-expect-error \"value\" is not a recognized property of EventTarget.\n            const { value } = event.target\n\n            setQuery(new SearchQuery({ search: value }))\n            view.dispatch({ effects: setSearchQuery.of(query()) })\n          }\n\n          return {\n            destroy: () => {\n              dispose()\n            },\n            dom: (\n              <div class='ink-mde-search-panel' onKeyDown={handleKeyDown}>\n                <input attr:main-field='true' class='ink-mde-search-input' onInput={updateSearch} onKeyDown={handleKeyDown} ref={el} type=\"text\" value={query().search} />\n              </div>\n            ) as HTMLElement,\n            mount: () => {\n              el?.focus()\n            },\n            top: true,\n          }\n        })\n      },\n    }),\n    keymap.of(searchKeymap),\n  ]\n}\n"],"names":["search","searchExtension","top","createPanel","view","createRoot","dispose","query","setQuery","createSignal","getSearchQuery","state","el","handleKeyDown","event","runScopeHandlers","preventDefault","code","shiftKey","findPrevious","findNext","updateSearch","value","target","SearchQuery","dispatch","effects","setSearchQuery","of","destroy","dom","_el$","_$getNextElement","_tmpl$","_el$2","firstChild","$$keydown","_ref$","_$use","$$input","_$setAttribute","_$effect","_$setProperty","_$runHydrationEvents","mount","focus","keymap","searchKeymap","_$delegateEvents"],"mappings":";;;;6GAIaA,IAASA,MACb,CACLC,EAAgB;AAAA,EACdC,KAAK;AAAA,EACLC,aAAcC,CAAAA,MACLC,EAAYC,CAAAA,MAAY;AAC7B,UAAM,CAACC,GAAOC,CAAQ,IAAIC,EAAaC,EAAeN,EAAKO,KAAK,CAAC;AACjE,QAAIC;AAEJ,UAAMC,IAAiBC,CAAAA,MAAyB;AAC9C,UAAIC,EAAiBX,GAAMU,GAAO,cAAc;AAAG,eAAOA,EAAME;AAEhE,MAAIF,EAAMG,SAAS,YACjBH,EAAME,eAAc,GAEhBF,EAAMI,WACRC,EAAaf,CAAI,IAEjBgB,EAAShB,CAAI;AAAA,OAKbiB,IAAgBP,CAAAA,MAAsB;AAE1C,YAAM;AAAA,QAAEQ,OAAAA;AAAAA,UAAUR,EAAMS;AAExBf,MAAAA,EAAS,IAAIgB,EAAY;AAAA,QAAExB,QAAQsB;AAAAA,MAAO,CAAA,CAAC,GAC3ClB,EAAKqB,SAAS;AAAA,QAAEC,SAASC,EAAeC,GAAGrB,GAAO;AAAA,MAAE,CAAC;AAAA;AAGvD,WAAO;AAAA,MACLsB,SAASA,MAAM;AACbvB,QAAAA;MACD;AAAA,MACDwB,MAAG,MAAA;AAAA,cAAAC,IAAAC,EAAAC,CAAA,GAAAC,IAAAH,EAAAI;AAAAJ,QAAAA,EAAAK,YAC4CvB;AAAa,cAAAwB,IACyDzB;AAAE,sBAAAyB,KAAAC,aAAAA,EAAAD,GAAAH,CAAA,IAAFtB,IAAEsB,GAAAA,EAAAE,YAAtBvB,GAAaqB,EAAAK,UAAtClB,GAAYmB,EAAAN,GAAA,cAAzD,MAAM,GAAAO,EAAA,MAAAC,EAAAR,YAA2G3B,EAAO,EAACP,MAAM,CAAA,GAAA2C,KAAAZ;AAAAA,SAE1I;AAAA,MAChBa,OAAOA,MAAM;AACXhC,QAAAA,GAAIiC,MAAK;AAAA,MACV;AAAA,MACD3C,KAAK;AAAA;EAET,CAAC;AAEJ,CAAA,GACD4C,EAAOlB,GAAGmB,CAAY,CAAC;AAE1BC,EAAA,CAAA,WAAA,OAAA,CAAA;"}